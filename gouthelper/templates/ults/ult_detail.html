{% extends "base.html" %}

{% load static %}
{% load project_tags %}

{% block heading %}
  <div class="row">
    <div class="col">
      <h1>Ult</h1>
    </div>
    <div class="col align-items-center d-flex justify-content-end">
      <a type="button"
         class="btn btn-primary btn-lg spacious-buttons"
         href="{% url 'ults:about' %}"
         role="button">About</a>
      {% if object.user %}
        <a type="button"
           class="btn btn-primary btn-lg spacious-buttons"
           href="{% url 'ults:pseudopatient-update' username=object.user.username %}"
           role="button">Update</a>
      {% else %}
        <a type="button"
           class="btn btn-primary btn-lg spacious-buttons"
           href="{% url 'ults:update' pk=object.pk %}"
           role="button">Update</a>
      {% endif %}
    </div>
  </div>
  <div class="row">
    <div class="col">
      <span>Jump to:</span> <a class="samepage-link" href="#recommendation">
        {% if object.recommendations.keys|length > 1 %}
          Recommendations
        {% else %}
          Recommendation
        {% endif %}
      </a> |
      <a class="samepage-link" href="#details">Details</a> |
      {% if object.urates_qs %}<a class="samepage-link" href="#urates">Urates</a> |{% endif %}
      <a class="samepage-link" href="#explanations">Explanations</a>
    </div>
    <div class="col align-items-center d-flex justify-content-end">
      {% if object.user %}<span>{{ object.user }}</span>{% endif %}
    </div>
  </div>
{% endblock heading %}
{% block content %}
  <main role="main">
    <div class="container bodytainer">
      <hr size="3" color="dark" />
      <div id="recommendation">
        <div class="row">
          <div class="col">
            <h2>
              <u>Recommendation</u>
            </h2>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="card card-body">
              <h3 div class="card-title">
                <b><u>{{ object.get_indication_display }}</u></b>
              </h3>
              <p class="card-text">
                {% if object.indication == 0 %}
                  ULT is <a href="{% url 'ults:about' %}#notindicated">not indicated</a> (the patient shouldn't be on ULT).
                {% elif object.indication == 1 %}
                  ULT is <a href="{% url 'ults:about' %}#conditional">conditionally indicated</a> (the patient should most likely be on ULT).
                {% elif object.indication == 2 %}
                  ULT is <a href="{% url 'ults:about' %}#strong">indicated</a> (the patient should be on ULT).
                {% endif %}
              </p>
            </div>
          </div>
        </div>
      </div>
      <hr size="3" color="dark" />
      <div id="details">
        <div class="row">
          <div class="col">
            <h2>
              <u>Details</u>
            </h2>
          </div>
          <div class="col align-items-center d-flex justify-content-end">
            <a href="#top"><small>Back to top</small></a>
          </div>
        </div>
        <div class="row">
          <div id="indications" class="col">
            <div class="card card-body" id="gout-card">
              <h3 class="card-title">
                <u>Gout</u>
              </h3>
              <div class="card-text">
                <ul>
                  <li>Total gout flares: {{ object.get_num_flares_display }}</li>
                  <li>{{ object.frequentflares_detail }}</li>
                  <li>{{ object.erosions_detail }}</li>
                  <li>{{ object.tophi_detail }}</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="card card-body" id="gout-card">
              <h3 class="card-title">
                <u>Medical</u>
              </h3>
              <div class="card-text">
                <ul>
                  <li>{{ object.ckd3_detail }}</li>
                  {% if object.has_conditional_indication_for_hyperuricemia %}
                    <li>Hyperuricemia: {{ object.hyperuricemia_detail }}</li>
                  {% endif %}
                  {% if object.multipleflares %}<li>{{ object.multipleflares_detail }}</li>{% endif %}
                  {% if object.has_conditional_indication_for_uratestones %}<li>{{ object.uratestones_detail }}</li>{% endif %}
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="explanations">
        <hr size="3" color="dark" />
        <div class="row">
          <div class="col">
            <h2>
              <u>Explanations</u>
            </h2>
          </div>
          <div class="col align-items-center d-flex justify-content-end">
            <a href="#top"><small>Back to top</small></a>
          </div>
        </div>
        <div class="accordion" id="accordionExplanations">
          {% for explanation in object.explanations %}
            {% include "explanation_accordion_item.html" with parent="accordionExplanations" id=explanation.0 label=explanation.1 bool=explanation.2 interp=explanation.3 %}
          {% endfor %}
        </div>
      </div>
      <a href="#top"><small>Back to top</small></a>
    </div>
  </main>
{% endblock content %}
